\documentclass[12pt]{article}

\usepackage{float, graphicx}
\usepackage[margin=2.5cm]{geometry}
\usepackage{amsmath, amsthm, amssymb}
% \usepackage{wrapfig}
% \usepackage[lined,boxed,commentsnumbered]{ algorithm2e }
\graphicspath{ { ./img/ } }
\newtheorem{definition}{Definition}
\renewcommand*\rmdefault{ptm}

\usepackage{setspace}
\doublespacing

% Allows us to write code in the text %
\def\code#1{\texttt{#1}}

\begin{document}

\begin{titlepage}
	\begin{center}
		~\\[2.0cm]
		{\Huge Simulating Tumor Growth Models and Sampling and its effects on Heterogeneity}\\[1.5cm]
		% {\Large HGEN 396: Human Genetics Research Project}\\[6.5cm]
		\emph{Student:}\\
		Mr. Zafarali Ahmed\\
		{\scriptsize zafarali [dot] ahmed [at] mail [dot] mcgill [dot] ca} \\[1.0cm]
		\emph{Supervisor:}\\
		Dr. Simon Gravel\\[1.0cm]
		\emph{Submission Date:}\\
		20th September 2015\\[1.0cm]
		\emph{Location:}\\
		McGill University
	\end{center}
\end{titlepage}

\begin{abstract}
\textbf{Background:}
Something about the background
\textbf{Methods:}
Methods and experimental design
\textbf{Results:}
Main results and observations
\textbf{Limitations:}
Limitations of the model proposed
\textbf{Conclusions:}
Conclustions of the paper

\end{abstract}

% 
% K E Y W O R D S 
% 
\textbf{Keywords:} cancer, tumor heterogeneity, cancer stem cells, compucational oncology, cellular potts model.

% 
% I N T R O D U C T I O N  
% 

\section{Introduction}
Cancer is the autonomous and uncontrolled growth of cells that forms a feed forward system to reinforce the tumorsâ€™ existence \cite{hallmarks}. Cancer originates from accumulated mutations in tumor supressor genes, proto-onco genes and DNA repair genes. These mutations hinder a cell's abillity to regulate its cell cycles, causing it to divide uncontrollably. However, for cancerous cells to keep growing and overcome the limitations of efficient diffusion of nutrients, tumors have two solutions: angiogenesis and metastasis. Angiogenesis permits a tumor to grow blood vessels and bring in nutrients. Metastasis is the migration of cancer cells to other parts of the body often via the permeable blood vessels formed during angiogenesis. It is often after metastasis that cancer becomes difficult to contain and treat despite surgical resection \cite{Demicheli2008}.

**** TALK ABOUT TUMOR HETEROGENEITY AND WHY IT MIGHT BE IMPORTANT IN THE CONTEXT OF TARGETTED MEDICINE. *****
**** ALSO TALK ABOUT SAMPLING PROBLEMS THAT CHANGE HETEROGENEITY ***8


\subsection{Motivation}


% 
% M E T H O D S 
% 

\section{Methods}
\subsection{Cellular Potts Model (CPM)}
The Cellular Potts Model (CPM) \cite{Graner1992} was used to simulate tissue cultures. The model is an extension of the q-Potts Model in statistical mechanics and is powerful due to its simplicity. 

The Cellular Potts Model consists of a $M\times M$ lattice of \emph{spins}. For a more biological interpretation, we can consider a \emph{spin} to represent an area of \emph{cell cytoplasm}. To maintain consistency with established literature, we will continue to use the term \emph{spin}. At any location of the lattice, $(x,y)$, a spin can take on a value, $\sigma(x,y) = \{0,1,\ldots N\}$. A \emph{cell}, $\sigma$, is defined as a collection of these spins; as such, this restricts same-spin values to be clustered together in the lattice. If $\sigma(x,y) = 0$, then this region is said to be the \emph{extra cellular matrix (ECM)}. To be able to simulate different \emph{types} of cells, for example proliferating and migrating cells, we introduce $\tau(\sigma)$, which returns the \emph{type} of the cell $\sigma$. Two cells can be seen in Figure \ref{basic}.

For each position on the lattice, we define a \emph{Hamiltonian}, $H$, as follows:
\begin{equation}
	H = H_{surface} + H_{area} + H_{gradients}
	\label{hamiltonian}
\end{equation}

\begin{itemize}
	\item $H_{surface}$ characterizes the surface tension between a cell, $\sigma$, and its neighbours, $\sigma'$.
	\item $H_{area}$ captures the dynamics of cells being restricted to a certain size due to limitations of diffusion and cell machinery. 
	\item $H_{gradients}$ captures any external forces applied to cells due to chemical potentials and other pertubations.
\end{itemize}

The simulation then proceeds via a Monte Carlo method to flip spins in the lattice in an attempt to grow and move cells. Cells will move to minimize the Hamiltonian (Equation \ref{hamiltonian}).

\subsubsection{Hamiltonian Equations}
Cells experience surface tensions when they interact with their environment. This effect is captured by the following Hamiltonian function:

\begin{equation}
	H_{surface} (x,y) = \sum_{\sigma' \in \text{neighbours}~\sigma} J(\tau(\sigma), \tau(\sigma'))(1-\delta(\sigma, \sigma'))
\end{equation}

$J(\tau_1, \tau_2)=J(\tau_2, \tau_1)$ is the cell-interaction function that returns the surface tension between two cell types, $\tau_1$ and $\tau_2$, and $\delta$ is the Kronecker delta function, $\delta(x,y)=\{1:~\text{if }x=y;~0:~\text{otherwise}\}$. The Kronecker delta function prevents us from considering two lattice positions of the same spin to have a surface tension since these two spins are part of the same cell.

Cells cannot grow indefinitely. If cells are too big, they cannot efficiently diffuse nutrients and shuttle machinery within their cell boundaries. This effect can be captured by the following Hamiltonian:

\begin{equation}
	H_{area} = \sum_{\text{all spins }\sigma} (a_{current}(\sigma)-a_{target})^2 \cdot \theta(a_{target}(\sigma))
	\label{H_area}
\end{equation}

Here $a_{current}(\sigma)$ and $a_{target}(\sigma)$ are functions that return the current and target area of the cell respectively, and $\theta(x)=\{0:~\text{if}~x\leq 0;~1:~\text{if}~x>0\}$ (Here $\theta(x)$ works to prevent us from considering negative target areas. This is essential because we define $a_{target}(\sigma_{ECM}) < 0$ when implementing the model).

Finally, we would like to add perturbations to our model. For example, we would like to simulate an oxygen gradient towards a blood vessel which would make it energetically favorable for cells to move away from the main tissue and toward the blood vessel. This effect can be captured with the following Hamiltonian:
\begin{equation}
	H_{gradients}(x,y) = V(x,y)
\end{equation}
Where $V(x,y)$ is some potential that we can change to simulate a variety of different effects.

\subsubsection{Monte Carlo Metropolis Algorithm}
Each \emph{spin copy attempt} of our simulation follows the algorithm outlined below \cite{Glazier2007}:

\begin{enumerate}
  \item Choose a lattice site at random $(x,y)$ with a spin $\sigma_{select}$
  \item Pick a trial spin $\sigma_{trial}$ from the neighbors around $(x,y)$
  \item Calculate $H_{initial}$ using $\sigma_{select}$
  \item Calculate $H_{final}$ using $\sigma_{trial}$
  \item Calcualte energy change, $\Delta H = H_{final} - H_{intial}$
  \item{ Change $\sigma_{select}$ to $\sigma_{trial}$ with the probability:
  \begin{equation}
 		P(\text{Spin Copy Attempt Successful}) =
  	\begin{cases}
   		1 & \text{if } \Delta H \leq 0 \\
   		\exp{(-\frac{\Delta H}{T})}       & \text{if } \Delta H > 0
  	\end{cases}
  	\label{p_attempt_success}
	\end{equation}
}
\end{enumerate}

Here the temperature, $T$, accounts for thermal fluctuations and adds a stochastic element to our algorithm. This allows for the case where an unfavourable spin copy attempt will be successful if it obtains some energy from the environment in the form of a 'thermal kick'. The higher $T$ is, the more likely an unfavorable spin copy attempt is successful.

\begin{definition}[Monte Carlo Time Step (MCS)] One Monte Carlo Time Step is $M^2$ spin copy attempts, where $M$ is the size of the lattice.
\end{definition}

We used a software called CompuCell3D \cite{Swat2012} (version 3.7.4) which is widely adopted by computational biologists aiming to simulate many different tissue systems.

\subsection{The Infinite Genome}


\subsection{}


% 
% R E S U L T S
% 
\section{Results}




% 
% D I S C U S S I O N S
% 
\section{Discussion}




% 
% C O N C L U S I O N
% 
\section{Conclustions}


\newpage
\bibliographystyle{abbrv}
\bibliography{citations}


\end{document}